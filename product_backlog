# ==== CONFIG ====
REPO="gym-workout-app"
OWNER="$(gh api user --jq .login)"  # or set YOUR GitHub username manually
SPRINT1_END="2025-10-27"

# ==== CREATE REPO ====
gh repo create "$OWNER/$REPO" --public --confirm
cd "$REPO"

# ==== BASE FILES ====
mkdir -p .github/ISSUE_TEMPLATE src
cat > README.md <<'MD'
# Gym Workout App

**Product Goal:** Digital platform for owner/trainers/clients to assign, track, and adapt workouts using performance + HRV data, with a social community.

**Sprint 1 Goal (Oct 13–Oct 27, 2025):** Enable secure login, roles, client profiles, assign 3-day plans, and client workout view.

## Quick Links
- Project Board: (add once created)
- Milestones: Sprint 1
- Top Sprint 1 Issues:
  - #2 Secure Access
  - #11 Roles & Permissions
  - #1 Client Profiles
  - #3 Assign Workouts (3-day plan)
  - #4 View Daily Workout
MD

mkdir -p .github/ISSUE_TEMPLATE
cat > .github/ISSUE_TEMPLATE/user-story.yml <<'YML'
name: User Story
description: Create a user story with acceptance criteria
title: "[Story]: "
labels: ["Story"]
body:
  - type: input
    id: role
    attributes:
      label: Role
      placeholder: e.g., client / trainer / owner / admin
    validations:
      required: true
  - type: textarea
    id: story
    attributes:
      label: User Story
      description: "As a <role>, I want <capability> so that <benefit>."
      placeholder: "As a client, I want to log my performance so that I can track progress."
    validations:
      required: true
  - type: textarea
    id: acceptance
    attributes:
      label: Acceptance Criteria
      description: Bullet list of clear, testable criteria (Gherkin or bullets).
      placeholder: |
        - Given I’m logged in, When I open Workout Today, Then I see clusters with sets×reps×weights.
        - Data persists and is visible in history.
    validations:
      required: true
  - type: dropdown
    id: priority
    attributes:
      label: Priority
      options:
        - P0-High
        - P1-Medium
        - P2-Low
    validations:
      required: true
  - type: checkboxes
    id: ready
    attributes:
      label: Definition of Ready (check all that apply)
      options:
        - label: Story sized to fit in a sprint
        - label: Acceptance criteria are clear
        - label: Dependencies identified
YML

git add .
git commit -m "chore: bootstrap repo with README and user story issue form"
git push -u origin HEAD

# ==== LABELS ====
for L in Epic Story Bug P0-High P1-Medium P2-Low "Sprint-1" "Sprint-2" Blocked Ready "In-Progress" Done; do
  gh label create "$L" -R "$OWNER/$REPO" -c "#777777" || true
done

# ==== MILESTONES ====
gh api repos/$OWNER/$REPO/milestones -f title='Sprint 1' -f state=open -f description='MVP: auth + profiles + assign/view 3-day plan' -f due_on="${SPRINT1_END}T23:59:59Z" > /dev/null

# ==== PROJECT (beta Projects) ====
PROJECT_ID=$(gh project create --owner "$OWNER" --title "Gym App – Scrum Board" --format json --jq .id)
# Add columns
gh project field-create "$PROJECT_ID" --name "Status" --data-type SINGLE_SELECT --options "Backlog,Ready,In Progress,Review,Done" > /dev/null

# Helper to add an issue, label, milestone, and project row
add_issue () {
  TITLE="$1"; BODY="$2"; PRIORITY="$3"; MILE="$4";
  NUM=$(gh issue create --title "$TITLE" --body "$BODY" --label "Story" --label "$PRIORITY" --repo "$OWNER/$REPO" --milestone "$MILE" --json number --jq .number)
  gh project item-add "$PROJECT_ID" --owner "$OWNER" --url "https://github.com/$OWNER/$REPO/issues/$NUM" > /dev/null
  echo "Created #$NUM $TITLE"
}

# ==== BACKLOG ISSUES ====
# Map from the assignment you gave me (IDs kept in comments)
add_issue "Owner – Client Profiles" \
"As a gym owner, I want to create/update client profiles (fitness level, injuries, goals) so that I can personalize training.

**Acceptance Criteria**
- Add/edit/view a client with fitness level, injuries, goals
- Validation and persistence" "P0-High" "Sprint 1"

add_issue "Client – Secure Access" \
"As a client, I want to sign up/log in/reset password so that only I access my workouts.

**Acceptance Criteria**
- Email+password auth, reset flow
- Sessions persist; safe failure on bad creds" "P0-High" "Sprint 1"

add_issue "Trainer – Assign 3-day Workouts (clusters/sets/reps/weights)" \
"As a trainer, I want to assign 3 daily workouts with clusters, sets, reps, weights, durations so that clients have a clear routine.

**Acceptance Criteria**
- Create/edit 3-day plan
- Add exercises to clusters; link to client
- Save plan" "P0-High" "Sprint 1"

add_issue "Client – View Daily Workout" \
"As a client, I want to see my today workout so that I can follow it at the gym.

**Acceptance Criteria**
- Daily screen lists clusters/exercises with sets×reps×weight and time blocks" "P0-High" "Sprint 1"

add_issue "Admin – Roles & Permissions" \
"As an admin, I want roles (owner/trainer/client) so that access is controlled.

**Acceptance Criteria**
- Role-based access enforced in UI/API" "P0-High" "Sprint 1"

# Remaining backlog (Sprint 2+)
add_issue "Client – Log Performance (sets/reps/weights)" \
"As a client, I want to record sets/reps/weights completed so that I can track progress.

**Acceptance Criteria**
- Per-exercise entries
- Edit mistaken entries
- History visible by date" "P0-High" ""

add_issue "Client – HRV/Recovery Input or Sync" \
"As a client, I want to enter/sync HRV/Recovery so that the plan adapts to my state.

**Acceptance Criteria**
- Manual field or device import
- Stored with session" "P1-Medium" ""

add_issue "System – Auto Adjust Based on Recovery" \
"As a client, I want suggested easier/harder variants when Recovery is low/high so that I train safely/effectively.

**Acceptance Criteria**
- Low-recovery → regressions/rest cues
- High-recovery → progressions" "P1-Medium" ""

add_issue "Client – Exercise Media (images/videos)" \
"As a client, I want images/videos for each exercise so that I can remember proper form.

**Acceptance Criteria**
- Each exercise links to at least one media object
- In-app viewer" "P0-High" ""

add_issue "Trainer – Progress Analytics (trends & exports)" \
"As a trainer, I want to see client trends (loads, reps, attendance) so that I can update plans.

**Acceptance Criteria**
- Graphs last 4–8 weeks
- Filter by exercise
- Export PNG/PDF" "P1-Medium" ""

add_issue "Owner – Community Feed (posts/comments)" \
"As a member, I want to share workout reflections and comment so that we build a social culture.

**Acceptance Criteria**
- Post text (+optional image)
- Like/comment; posts tied to sessions" "P2-Low" ""

add_issue "Non-Functional – Mobile Friendly" \
"As a user, I want responsive screens so that I can use the app on my phone.

**Acceptance Criteria**
- Pass basic responsive checks; tap targets ≥44px" "P0-High" ""

# Add project link to README
PROJECT_URL=$(gh project view "$PROJECT_ID" --web --format json --jq .url 2>/dev/null || echo "")
[ -n "$PROJECT_URL" ] && perl -0777 -pe "s|Project Board: \(add once created\)|Project Board: $PROJECT_URL|" -i README.md

git add README.md
git commit -m "docs: link project board in README"
git push
